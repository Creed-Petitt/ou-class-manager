"use client"

import { useId } from "react"
import Link from "next/link"
import { usePathname } from "next/navigation"
import {
  HomeIcon,
  CalendarDaysIcon,
  TrendingUpIcon,
} from "lucide-react"

import ThemeToggle from "@/components/navbar-components/theme-toggle"
import UserMenu from "@/components/navbar-components/user-menu"
import { Button } from "@/components/ui/button"
import {
  NavigationMenu,
  NavigationMenuItem,
  NavigationMenuLink,
  NavigationMenuList,
} from "@/components/ui/navigation-menu"
import {
  Popover,
  PopoverContent,
  PopoverTrigger,
} from "@/components/ui/popover"
import {
  Tooltip,
  TooltipContent,
  TooltipProvider,
  TooltipTrigger,
} from "@/components/ui/tooltip"

// Navigation links with icons for desktop icon-only navigation
const navigationLinks = [
  { href: "/dashboard", label: "Dashboard", icon: HomeIcon },
  { href: "/scheduler", label: "Scheduler", icon: CalendarDaysIcon },
  { href: "/progress", label: "Degree Progress", icon: TrendingUpIcon },
]

export default function CustomNavbar() {
  const id = useId()
  const pathname = usePathname()

  return (
    <header className="px-2 md:px-3 mb-2">
      <div className="flex h-14 items-center justify-between gap-4">
        {/* Left side */}
        <div className="flex flex-1 items-center gap-4">
          {/* Logo and Brand */}
          <div className="flex items-center gap-2">
            <svg 
              width="40" 
              height="40" 
              viewBox="0 0 1024 1024" 
              className="rounded-md"
              fill="currentColor"
            >
              <path d="M369.834595,694.973145 C355.201508,703.562561 339.728760,705.376038 323.401672,704.533813 C308.444427,703.762207 293.416077,704.379272 278.419067,704.365112 C248.902969,704.337280 223.386215,682.530090 218.596390,653.484436 C217.885880,649.175842 217.647446,644.913757 217.647614,640.591614 C217.651428,542.944336 217.638824,445.297089 217.659851,347.649811 C217.664993,323.808411 236.156540,299.525208 258.381104,294.311523 C265.087433,292.738281 271.980377,293.746765 278.787506,293.807007 C281.837616,293.833954 281.300751,296.412018 281.315002,298.295593 C281.377899,306.626831 281.846619,314.995819 281.231567,323.281616 C280.333893,335.374603 288.907837,344.257111 297.908447,347.979919 C312.999207,354.221802 325.238037,350.787506 335.176147,341.530090 C339.673859,337.340454 341.629211,331.937164 341.643311,325.829315 C341.662903,317.331024 341.625366,308.832581 341.671844,300.334503 C341.681671,298.545471 341.278320,296.671936 342.488831,294.647827 C344.949097,294.647827 347.569794,294.648560 350.190491,294.647705 C379.018097,294.638275 407.846069,294.701355 436.672821,294.539703 C440.949432,294.515717 442.760406,295.651245 442.384064,300.160553 C440.542694,322.226776 452.060181,336.604950 469.842651,347.278015 C496.769348,363.439453 526.061035,370.249969 557.250854,368.525604 C579.636230,367.288055 600.649902,360.620575 620.587769,350.463837 C622.460571,349.509796 624.192993,348.009552 626.571045,348.337494 C627.814514,350.001373 627.324585,351.887878 627.325806,353.648651 C627.354919,397.473206 627.316528,441.297821 627.408752,485.122223 C627.416199,488.662811 626.500793,491.441559 624.267944,494.216217 C614.443237,506.425201 603.927368,518.027832 593.553467,529.756470 C592.705933,530.714722 592.002441,531.972168 590.316528,531.836670 C588.997864,530.448669 589.652771,528.705017 589.651794,527.138733 C589.625183,485.980316 589.643921,444.821930 589.646851,403.663513 C589.647400,396.239349 588.791931,395.384033 581.320374,395.344330 C576.321533,395.317749 571.321167,395.419800 566.323608,395.338226 C465.715851,393.696350 365.100159,394.610077 264.488068,394.381348 C255.672958,394.361298 255.044632,394.932800 255.041336,403.653534 C255.011185,483.636627 254.988846,563.619690 255.008865,643.602783 C255.012299,657.270691 264.610870,666.622070 278.440063,666.623657 C326.763702,666.629211 375.087311,666.618408 423.410950,666.613770 C425.659149,666.613586 427.907379,666.613770 430.155579,666.613770 C430.280243,667.138611 430.404907,667.663391 430.529572,668.188232 C410.413818,677.064453 390.298065,685.940674 369.834595,694.973145z"/>
              <path d="M610.261597,695.282959 C553.389832,743.813416 489.916931,779.591309 418.392975,800.725159 C407.063629,804.072815 395.486694,806.233887 383.868469,808.211304 C382.276428,808.482239 380.598541,808.248535 378.846436,808.248535 C379.002594,805.619995 381.027405,805.601624 382.366150,805.074280 C423.289368,788.954712 461.575226,767.821838 498.497528,744.090698 C523.318665,728.137329 547.350708,711.093445 570.025024,692.182739 C573.475159,689.305237 576.789062,686.264648 580.230347,683.376343 C587.165833,677.555237 591.297974,670.600708 589.579712,661.142273 C589.008423,657.997192 591.332214,653.583252 587.889648,651.928711 C584.646912,650.370361 582.034485,654.227905 579.409790,656.049500 C556.136414,672.202026 532.322754,687.496582 507.650604,701.427429 C470.425507,722.446228 431.697693,740.036926 390.535492,751.889404 C359.779846,760.745361 328.514343,766.480042 296.395935,767.567505 C284.044189,767.985657 271.759949,767.066406 259.442993,767.331787 C257.704773,767.369202 255.792099,767.583191 254.224762,765.477234 C263.968079,762.220825 273.434540,759.249268 282.767792,755.905762 C335.674286,736.952820 387.187866,714.916016 436.061249,686.957275 C479.639008,662.027893 521.850464,635.086609 560.872803,603.381165 C585.713196,583.198486 609.627991,561.971741 631.676697,538.741943 C653.010010,516.265869 672.909912,492.598145 690.634155,467.115692 C699.479553,454.398590 708.190369,441.610352 716.297424,428.412476 C716.994446,427.277710 717.618042,426.097900 718.277710,424.940155 C720.465393,421.101074 719.820801,418.620605 715.304871,416.992645 C704.350525,413.043579 693.511169,408.774384 682.638916,404.599365 C680.844849,403.910461 678.663330,403.808990 677.437561,401.262848 C714.423767,377.213959 751.406799,353.167084 789.386902,328.471924 C799.693665,371.819427 809.665039,413.756561 819.825134,456.487274 C813.702454,455.693848 809.344238,453.186432 804.748718,451.532928 C797.081177,448.774170 789.484863,445.803192 781.946594,442.707092 C778.870056,441.443481 777.204346,442.120941 775.524841,445.004120 C756.271606,478.057434 733.726868,508.707001 708.680786,537.627869 C689.678467,559.570129 668.904053,579.733337 648.294556,600.080811 C643.327759,604.984436 637.877930,609.409058 632.535461,613.917847 C629.355164,616.601868 628.186401,619.748596 628.241028,623.959290 C628.455261,640.453308 628.260620,656.952271 628.385986,673.448181 C628.410706,676.704102 627.531006,679.236145 625.141174,681.420837 C620.225098,685.915100 615.401978,690.510986 610.261597,695.282959z"/>
              <path d="M636.265991,770.344849 C599.277222,794.557434 560.442261,814.149963 518.421814,826.998108 C492.806915,834.830017 466.730255,840.441162 439.916290,842.505798 C422.592529,843.839600 405.336945,843.663208 388.058746,842.291138 C386.483582,842.166016 384.671295,842.384827 383.635834,840.895264 C524.941589,805.786926 638.257446,729.662781 723.008545,609.875244 C710.904236,601.104797 696.868042,596.850769 683.813416,588.389648 C722.138000,567.285339 759.520935,546.699646 797.884766,525.573792 C803.779846,568.640503 809.515320,610.541016 815.242737,652.382507 C812.547058,653.636108 811.022217,651.933228 809.371948,651.077148 C799.761658,646.091309 790.131104,641.137146 780.651733,635.910522 C777.507874,634.177185 775.630310,634.573914 773.643005,637.509094 C754.213135,666.206482 731.032043,691.685181 705.922363,715.425537 C684.455322,735.721985 661.225281,753.856445 636.265991,770.344849z"/>
              <path d="M516.946289,268.187927 C483.624725,252.458847 450.646027,236.884018 417.674957,221.293030 C413.912109,219.513702 410.183716,217.660675 406.454926,215.810455 C403.796295,214.491241 401.711151,212.744492 401.678741,209.413055 C401.647522,206.201523 403.782410,204.628571 406.250793,203.480865 C416.968781,198.497528 427.681335,193.497452 438.484528,188.703323 C472.581909,173.571930 506.760101,158.621796 540.799561,143.361801 C546.308655,140.892075 551.204468,141.795410 556.156494,143.973160 C603.102173,164.618576 650.018921,185.329849 696.928833,206.056473 C698.977173,206.961487 701.324951,207.554596 701.477722,210.663620 C701.638550,213.938339 699.716614,215.574371 697.317017,216.875427 C693.072083,219.177002 688.769043,221.378433 684.425781,223.488800 C682.038757,224.648636 681.069946,226.318146 681.058105,229.002853 C681.041260,232.808380 680.618774,236.613876 680.327087,240.416122 C678.949768,258.363586 682.706909,275.743103 685.594055,293.292786 C687.167175,302.854736 688.116760,312.683136 687.411316,322.521149 C687.187622,325.640839 685.341187,326.975952 682.898865,327.776428 C676.219910,329.965607 669.536072,329.977814 662.826843,327.642883 C659.869568,326.613739 658.337463,324.832458 658.675110,321.720825 C660.516357,304.753693 658.611267,287.522339 662.819885,270.685699 C665.052795,261.752991 663.330994,252.440369 663.605835,243.304047 C663.698486,240.225006 664.572754,237.020538 663.165649,233.984909 C661.079712,233.220169 659.532043,234.460556 657.929260,235.179932 C623.447693,250.656723 588.965759,266.132874 554.538330,281.729431 C551.957092,282.898773 549.880676,282.619934 547.427856,281.675964 C537.159790,277.724060 527.265686,272.943237 516.946289,268.187927z"/>
              <path d="M365.396240,509.604034 C374.830109,519.048401 384.134460,528.127136 393.134705,537.497925 C396.405914,540.903809 398.629395,541.078796 402.071991,537.641541 C431.898804,507.860718 461.882904,478.237579 491.792847,448.539917 C496.299957,444.064789 500.784393,440.070679 507.403381,438.409637 C515.967102,436.260559 527.226379,441.990356 530.957642,448.809113 C535.765869,457.595978 534.841309,467.921265 528.168091,475.179840 C525.125854,478.488983 521.886902,481.619537 518.692993,484.786530 C483.912262,519.274109 448.945374,553.576721 414.435791,588.333435 C402.968536,599.882751 391.501190,599.094666 380.792603,588.250793 C362.997955,570.231262 345.004486,552.408142 327.094635,534.502319 C325.209412,532.617554 323.296234,530.759766 321.442261,528.844727 C312.561951,519.671936 312.279510,505.482239 320.787872,496.859833 C329.181061,488.354218 343.044464,488.198334 352.356476,496.703186 C356.780670,500.743927 360.892853,505.126282 365.396240,509.604034z"/>
              <path d="M593.352783,283.213989 C609.149109,276.144287 624.603638,269.236938 639.875305,262.411346 C641.905151,263.990173 641.309753,265.789764 641.315552,267.345306 C641.368347,281.510040 641.300903,295.675293 641.370850,309.839905 C641.398132,315.360931 639.562744,319.628204 634.989380,323.110474 C614.366211,338.813324 591.162842,348.048523 565.557983,351.412140 C531.305420,355.911743 500.423187,346.997223 472.206573,327.705261 C463.361359,321.657715 459.597168,313.028961 459.640198,302.493805 C459.687164,290.995392 459.640991,279.496582 459.660187,267.998047 C459.662903,266.367615 459.805664,264.737427 459.876709,263.251251 C462.409515,262.079041 464.057831,263.539154 465.788666,264.354523 C491.548676,276.489746 517.319275,288.603058 543.016846,300.869415 C546.777344,302.664398 549.923401,302.839050 553.835083,300.993103 C566.781738,294.883423 579.936218,289.214386 593.352783,283.213989z"/>
              <path d="M326.339661,322.798218 C326.066132,332.787872 320.575409,339.023407 312.196289,339.331238 C303.180420,339.662445 296.656464,334.221466 296.312195,324.493408 C295.730743,308.065399 295.245270,291.590118 296.648865,275.170410 C297.359741,266.854584 304.109131,261.259583 312.211670,261.681061 C320.130981,262.093018 326.253876,268.579468 326.305786,276.935577 C326.399780,292.065369 326.337402,307.196136 326.339661,322.798218z"/>
            </svg>
            <span className="font-semibold text-foreground">UniFlow</span>
          </div>
          {/* Mobile menu trigger */}
          <Popover>
            <PopoverTrigger asChild>
              <Button
                className="group size-8 md:hidden"
                variant="ghost"
                size="icon"
              >
                <svg
                  className="pointer-events-none"
                  width={16}
                  height={16}
                  viewBox="0 0 24 24"
                  fill="none"
                  stroke="currentColor"
                  strokeWidth="2"
                  strokeLinecap="round"
                  strokeLinejoin="round"
                  xmlns="http://www.w3.org/2000/svg"
                >
                  <path
                    d="M4 12L20 12"
                    className="origin-center -translate-y-[7px] transition-all duration-300 ease-[cubic-bezier(.5,.85,.25,1.1)] group-aria-expanded:translate-x-0 group-aria-expanded:translate-y-0 group-aria-expanded:rotate-[315deg]"
                  />
                  <path
                    d="M4 12H20"
                    className="origin-center transition-all duration-300 ease-[cubic-bezier(.5,.85,.25,1.8)] group-aria-expanded:rotate-45"
                  />
                  <path
                    d="M4 12H20"
                    className="origin-center translate-y-[7px] transition-all duration-300 ease-[cubic-bezier(.5,.85,.25,1.1)] group-aria-expanded:translate-y-0 group-aria-expanded:rotate-[135deg]"
                  />
                </svg>
              </Button>
            </PopoverTrigger>
            <PopoverContent align="start" className="w-36 p-1 md:hidden">
              <NavigationMenu className="max-w-none *:w-full">
                <NavigationMenuList className="flex-col items-start gap-0 md:gap-2">
                  {navigationLinks.map((link, index) => {
                    const Icon = link.icon
                    const isActive = pathname === link.href
                    return (
                      <NavigationMenuItem key={index} className="w-full">
                        {link.disabled ? (
                          <div className="flex-row items-center gap-2 py-1.5 px-3 text-muted-foreground cursor-not-allowed">
                            <Icon
                              size={16}
                              className="text-muted-foreground opacity-50"
                              aria-hidden="true"
                            />
                            <span className="opacity-50">{link.label}</span>
                          </div>
                        ) : (
                          <NavigationMenuLink
                            href={link.href}
                            className="flex-row items-center gap-2 py-1.5"
                            active={isActive}
                          >
                            <Icon
                              size={16}
                              className="text-muted-foreground"
                              aria-hidden="true"
                            />
                            <span>{link.label}</span>
                          </NavigationMenuLink>
                        )}
                      </NavigationMenuItem>
                    )
                  })}
                </NavigationMenuList>
              </NavigationMenu>
            </PopoverContent>
          </Popover>
          <div className="flex items-center gap-2">
            {/* Desktop navigation - icon only */}
            <NavigationMenu className="hidden md:flex">
              <NavigationMenuList className="gap-1">
                <TooltipProvider>
                  {navigationLinks.map((link) => {
                    const isActive = pathname === link.href
                    return (
                      <NavigationMenuItem key={link.label}>
                        <Tooltip>
                          <TooltipTrigger asChild>
                            {link.disabled ? (
                              <div className="flex size-8 items-center justify-center p-1.5 rounded-md text-muted-foreground opacity-50 cursor-not-allowed">
                                <link.icon size={18} aria-hidden="true" />
                                <span className="sr-only">{link.label}</span>
                              </div>
                            ) : (
                              <NavigationMenuLink
                                href={link.href}
                                className={`flex size-8 items-center justify-center p-1.5 rounded-md transition-colors ${
                                  isActive 
                                    ? "bg-muted text-foreground" 
                                    : "text-muted-foreground hover:text-foreground hover:bg-muted/50"
                                }`}
                              >
                                <link.icon size={18} aria-hidden="true" />
                                <span className="sr-only">{link.label}</span>
                              </NavigationMenuLink>
                            )}
                          </TooltipTrigger>
                          <TooltipContent
                            side="bottom"
                            className="px-2 py-1 text-xs"
                          >
                            <p>{link.label}</p>
                          </TooltipContent>
                        </Tooltip>
                      </NavigationMenuItem>
                    )
                  })}
                </TooltipProvider>
              </NavigationMenuList>
            </NavigationMenu>
          </div>
        </div>
        {/* Right side */}
        <div className="flex items-center gap-1">
          {/* Theme toggle */}
          <ThemeToggle />
          {/* User menu */}
          <UserMenu />
        </div>
      </div>
    </header>
  )
}